
<ui>
	<block className="HeaderShipList">
		<bind name="controller" value="lesta.dialogs.controllers.EntitySingletonController; 'gameInfo'"/>
		<bind name="collectionDH" value="CC.avatar; 'allyCollection'; 'team.ally.sortedDead'"/>
		<bind name="collectionDH" value="CC.avatar; 'selfAvatarCollection'+'ROOT'"/>
		<bind name="collectionDesign" value="'DES_'+'selfAvatarCollection'+'ROOT'; 'selfAvatarCollection'; {'filter':$entity.relation.value == 0}; []"/>
		<bind name="watch" value="'selfAvatarEntityId'; selfAvatarCollection[0].id"/>
		<bind name="entityDH" value="'selfAvatarEntity'; selfAvatarEntityId"/>
		<bind name="watchDH" value="'playerIsAlive'; ['selfAvatarEntity.health.evKilled']; selfAvatarEntity.health.isAlive"/>
		<bind name="watchDH" value="'killerId'; ['selfAvatarEntity.health.evKilled']; selfAvatarEntity.health.killerId"/>
		<bind name="primaryEntityDH" value="'killerEntity'; CC.avatar; killerId"/>
		<styleClass value="$Fullsize"/>
		<bind name="visible" value="gameInfo.gameModeId != GameMode.TUTORIAL"/>
		<block>
			<style>
				<top value="15px"/>
				<left value="50%"/>
				<position value="absolute"/>
			</style>
			<block>
				<style>
					<height value="20px"/>
					<position value="absolute"/>
				</style>
				<bind name="watch" value="'paddingLeft'; (gameInfo.gameModeId != GameMode.PVE) ? '-50px' : (30 + ((allyCollection.length-1) * 26)) * 0.5 - 30)"/>
				<bind name="style" value="'left';  paddingLeft"/>
				<bind name="collectionRepeatDH" value="CC.avatar; 'HeaderShipListRenderer'; 'team.ally.sortedDead'; {_isAllyTeam: true, _isEnemyTeam: false}"/>
			</block>
			<block>
				<bind name="visible" value="gameInfo.gameModeId != GameMode.PVE"/>
				<style>
					<height value="20px"/>
					<left value="20px"/>
					<position value="absolute"/>
				</style>
				<bind name="collectionRepeatDH" value="CC.avatar; 'HeaderShipListRenderer'; 'team.enemy.sortedDead'; {_isAllyTeam: false, _isEnemyTeam: true}"/>
			</block>
		</block>
	</block>
	<block className="HeaderShipListRenderer">
		<bind name="name" value="'HeaderIconShip_'+ (_isAllyTeam ? 'Ally_' : 'Enemy_') + $index"/>
		<bind name="dataRefDH" value="'playerEntity'; '$dataRef.ref'"/>
		<bind name="watchDH" value="'relation'; 			['playerEntity.relation.evChanged']; playerEntity.relation.value"/>
		<bind name="watchDH" value="'isAlive'; 			['playerEntity.health.evKilled']; playerEntity.health.isAlive"/>
		<bind name="watchDH" value="'tkStatus'; 			['playerEntity.avatar.evTeamkillStatusChanged']; playerEntity.avatar.tkStatus"/>
		<bind name="watchDH" value="'rawShipSubtype';	[]; playerEntity.avatar.ship.ref.ship.subtype"/>
		<bind name="watchDH" value="'ttkStatus'; 		['playerEntity.avatar.evTTKStatusChanged']; playerEntity.avatar.ttkStatus"/>
		<bind name="watchDH" value="'isInSameDivision'; 	['playerEntity.avatar.evDivisionChanged']; playerEntity.avatar.isInSameDivision"/>
		<bind name="watchDH" value="'flags'; 			['playerEntity.target.evChanged']; playerEntity.target.flags"/>
		<bind name="watch" value="'isSelf'; (relation == 0)"/>
		<bind name="watch" value="'isDeadEnemy'; _isEnemyTeam &amp;&amp; !isAlive"/>
		<bind name="handleEventDH" value="'playerEntity.avatarAnimation.evPlayDeathAnimation'; 'evItemDeath'"/>
		<bind name="handleEventDH" value="'playerEntity.avatarAnimation.evPlayMoveAnimation'; 'evItemMove'"/>
		<bind name="var" value="{posMultiplier: _isAllyTeam ? -1 : 1}"/>
		<bind name="var" value="{startXPosition:  posMultiplier * ($index * (20 + 6))}"/>
		<style>
			<position value="absolute"/>
			<marginLeft value="10px"/>
			<marginTop value="5px"/>
			<width value="20px"/>
			<height value="20px"/>
		</style>
		<bind name="left" value="(startXPosition)"/>
		<bind name="appear" value="'evItemMove'; 0.15; 0.15; { left : posMultiplier*playerEntity.avatarAnimation.fromIndex * (20 + 6) }; {left : posMultiplier*playerEntity.avatarAnimation.toIndex * (20 + 6)}"/>
		<bind name="dispatch" value="'evItemDeath'; 'evItemDeath_disappear'; []; false; 0"/>
		<bind name="dispatch" value="'evItemDeath_disappear'; 'evItemDeath_move'; []; false; 0.15"/>
		<bind name="dispatch" value="'evItemDeath_move'; 'evItemDeath_appear'; []; false; 0.15"/>
		<bind name="appear" value="'evItemDeath_disappear'; 0.15; 0; { alpha: 1, scaleX: 1, scaleY: 1 }; { alpha : 0, scaleX: 0.1, scaleY: 0.1 }"/>
		<bind name="appear" value="'evItemDeath_move'; 0.15; 0; { left : posMultiplier*playerEntity.avatarAnimation.fromIndex * (20 + 6) }; {left : posMultiplier*playerEntity.avatarAnimation.toIndex * (20 + 6) }"/>
		<bind name="appear" value="'evItemDeath_appear'; 0.15; 0; { alpha: 0, scaleX: 0.1, scaleY: 0.1 }; { alpha : 1, scaleX: 1, scaleY: 1 } "/>
		<block className="HeaderShipMarker">
			<style>
				<marginLeft value="-10px"/>
				<marginTop value="-5px"/>
			</style>
			<styleClass value="$Fullsize"/>
			<block className="lesta.controls.BitmapEx" type="native">
				<styleClass value="$MiddleAligned"/>
				<bind name="watch" value="'shipSubtype'; (rawShipSubtype == ShipTypes.AircraftCarrier) ? 'Carrier' : rawShipSubtype"/>
				<bind name="scaleX" value="isDeadEnemy ? -1 : 1"/>
				<bind name="scaleY" value="isDeadEnemy ? -1 : 1"/>
				<bind name="style" value="'marginLeft'; isDeadEnemy ? '50%' : '-50%'"/>
				<bind name="style" value="'marginTop'; isDeadEnemy ? '100%' : 0"/>
				<bind name="bitmapDataClassName" value="
									isAlive ?
										isSelf ?
											tkStatus ?
													'teamkiller_'+toLowerCase(shipSubtype)
											:
												toLowerCase(shipSubtype)+'_small_own'
										:
											_isAllyTeam ?
												ttkStatus ?
													'henkey_ally_' + toLowerCase(shipSubtype)
												:
													isInSameDivision ?
														tkStatus ?
															'division_'+toLowerCase(shipSubtype)
														:
															'division_'+toLowerCase(shipSubtype)
													:
														tkStatus ?
															'teamkiller_'+toLowerCase(shipSubtype)
														:
															'ally_' + toLowerCase(shipSubtype)
											:
												ttkStatus ?
													'henkey_enemy_' + toLowerCase(shipSubtype)
												:
													'enemy_' + toLowerCase(shipSubtype) + '_small'
									:
										_isAllyTeam ?
											toLowerCase(shipSubtype)+'_sunk_small'
										:
											toLowerCase(shipSubtype)+'_sunk_small'
		"/>
			</block>
			<block>
				<style>
					<left value="50%"/>
					<marginLeft value="-45%"/>
					<top value="5px"/>
					<position value="absolute"/>
				</style>
				<block className="lesta.controls.BitmapEx" type="native">
					<bind name="visible" value="(flags &amp; (1 &lt;&lt; WeaponType.ARTILLERY)) != 0"/>
					<bind name="bitmapDataClassName" value="'aww_priority_attack_small'"/>
				</block>
				<block className="lesta.controls.BitmapEx" type="native">
					<bind name="visible" value="(flags &amp; (1 &lt;&lt; WeaponType.ATBA)) != 0"/>
					<bind name="bitmapDataClassName" value="'scaliber_priority_attack_small'"/>
				</block>
				<style>
					<flow value="horizontal"/>
				</style>
			</block>
		</block>
	</block>
	<block className="HeaderShipMarker">
		<style>
			<marginLeft value="-10px"/>
			<marginTop value="-5px"/>
		</style>
		<styleClass value="$Fullsize"/>
		<block className="lesta.controls.BitmapEx" type="native">
			<styleClass value="$MiddleAligned"/>
			<bind name="watch" value="'shipSubtype'; (rawShipSubtype == ShipTypes.AircraftCarrier) ? 'Carrier' : rawShipSubtype"/>
			<bind name="scaleX" value="isDeadEnemy ? -1 : 1"/>
			<bind name="scaleY" value="isDeadEnemy ? -1 : 1"/>
			<bind name="style" value="'marginLeft'; isDeadEnemy ? '50%' : '-50%'"/>
			<bind name="style" value="'marginTop'; isDeadEnemy ? '100%' : 0"/>
			<bind name="bitmapDataClassName" value="
									isAlive ?
										isSelf ?
											tkStatus ?
													'teamkiller_'+toLowerCase(shipSubtype)
											:
												toLowerCase(shipSubtype)+'_small_own'
										:
											_isAllyTeam ?
												ttkStatus ?
													'henkey_ally_' + toLowerCase(shipSubtype)
												:
													isInSameDivision ?
														tkStatus ?
															'division_'+toLowerCase(shipSubtype)
														:
															'division_'+toLowerCase(shipSubtype)
													:
														tkStatus ?
															'teamkiller_'+toLowerCase(shipSubtype)
														:
															'ally_' + toLowerCase(shipSubtype)
											:
												ttkStatus ?
													'henkey_enemy_' + toLowerCase(shipSubtype)
												:
													'enemy_' + toLowerCase(shipSubtype) + '_small'
									:
										_isAllyTeam ?
											toLowerCase(shipSubtype)+'_sunk_small'
										:
											toLowerCase(shipSubtype)+'_sunk_small'
		"/>
		</block>
		<block>
			<style>
				<left value="50%"/>
				<marginLeft value="-45%"/>
				<top value="5px"/>
				<position value="absolute"/>
			</style>
			<block className="lesta.controls.BitmapEx" type="native">
				<bind name="visible" value="(flags &amp; (1 &lt;&lt; WeaponType.ARTILLERY)) != 0"/>
				<bind name="bitmapDataClassName" value="'aww_priority_attack_small'"/>
			</block>
			<block className="lesta.controls.BitmapEx" type="native">
				<bind name="visible" value="(flags &amp; (1 &lt;&lt; WeaponType.ATBA)) != 0"/>
				<bind name="bitmapDataClassName" value="'scaliber_priority_attack_small'"/>
			</block>
			<style>
				<flow value="horizontal"/>
			</style>
		</block>
	</block>
</ui>
